<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.xiangqian.auto.deploy.mapper.ItemMapper">

    <select id="list" resultType="org.xiangqian.auto.deploy.entity.ItemEntity">
        <!--  -->
        SELECT
        i.*,
        g.name AS 'git_name',
        s.name AS 'server_name',
        COUNT(ui.user_id) AS 'user_count'
        FROM item i
        LEFT JOIN git g ON g.id = i.git_id
        LEFT JOIN server s ON s.id = i.server_id
        LEFT JOIN user_item ui ON ui.item_id = i.id
        GROUP BY i.id
    </select>

</mapper>
